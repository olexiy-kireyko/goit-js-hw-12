{"version":3,"file":"index.js","sources":["../src/img/octagon.svg","../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["export default \"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20fill='none'%3e%3cg%20fill='%23FAFAFB'%20clip-path='url(%23a)'%3e%3cpath%20d='M6.81.219A.75.75%200%200%201%207.34%200h9.32a.75.75%200%200%201%20.53.219l6.591%206.591a.75.75%200%200%201%20.219.53v9.32a.75.75%200%200%201-.219.53l-6.591%206.591a.75.75%200%200%201-.53.219H7.34a.75.75%200%200%201-.53-.219L.219%2017.19A.75.75%200%200%201%200%2016.66V7.34a.75.75%200%200%201%20.219-.53L6.81.219ZM7.65%201.5%201.5%207.65v8.7l6.15%206.15h8.7l6.15-6.15v-8.7L16.35%201.5h-8.7Z'/%3e%3cpath%20d='M6.969%206.97a.75.75%200%200%201%201.062%200L12%2010.94l3.969-3.97a.75.75%200%201%201%201.062%201.061l-3.97%203.97%203.97%203.968a.753.753%200%200%201%200%201.062.749.749%200%200%201-1.062%200L12%2013.061l-3.969%203.97a.75.75%200%200%201-1.225-.243.751.751%200%200%201%20.163-.819L10.939%2012%206.97%208.031a.75.75%200%200%201%200-1.062Z'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='a'%3e%3cpath%20fill='%23fff'%20d='M0%200h24v24H0z'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e\"","'use strict';\n\nimport axios from 'axios';\n\nexport let lastPageNumber;\n\nexport async function getPixabayImages(value, pageNumber) {\naxios.defaults.baseURL = 'https://pixabay.com';\n\n  const searchParams = {\n    key: '46785976-efe48924e46a3ec0e24bd3bdc',\n    q: value,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: pageNumber,\n    per_page: 15,\n  };\n\n  const images = await axios.get('/api', { params: searchParams });\n\n  if (images.data.total === 0) {\n    throw new Error(\n      'Sorry, there are no images matching your search query. Please try again!'\n    );\n  }\n  lastPageNumber = Math.ceil(images.data.totalHits / searchParams.per_page);\n\n  return images.data;\n}\n","'use strict';\n\nexport function renderPixabayImgList(images, searchList) {\n  const imagesList = images\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `\n        <li class=\"gallery-item\">\n          <a href=${largeImageURL} class=\"gallery-ref\">\n            <img class=\"gallery-img\" src=${webformatURL} alt=\"${tags}\" title=\"\"/>\n          </a>\n            <ul class=\"gallery-descrip\">\n          <li><b>likes</b><span>${likes}</span></li>\n          <li><b>views</b><span>${views}</span></li>\n          <li><b>comments</b><span>${comments}</span></li>\n          <li><b>downloads</b><span>${downloads}</span></li>\n             </ul>\n        </li>`;\n      }\n    )\n    .join('');\n  searchList.insertAdjacentHTML('beforeend', imagesList);\n}\n","'use strict';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport octagon from '/img/octagon.svg';\nimport { getPixabayImages, lastPageNumber } from './js/pixabay-api';\nimport { renderPixabayImgList } from './js/render-functions';\n\nconst searchForm = document.querySelector('.search');\nconst searchList = document.querySelector('.gallery');\nconst spinner = document.querySelector('.spinner');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nsearchForm.addEventListener('submit', handlerSubmit);\nloadMoreBtn.addEventListener('click', handleLoadMoreBtn);\n\nlet gallery = new SimpleLightbox('.gallery a', {\n  captionType: 'attr',\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n});\n\nconst iziToastOptions = {\n  iconUrl: octagon,\n  backgroundColor: 'red',\n  messageColor: 'white',\n  layout: 2,\n  closeOnClick: true,\n  close: false,\n  position: 'center',\n  messageSize: 24,\n  timeout: 3000,\n};\n\nlet pageNumber;\nlet searchValue;\n\nasync function handlerSubmit(event) {\n  event.preventDefault();\n  searchValue = event.currentTarget.elements.searchInput.value.trim();\n\n  if (!searchValue) {\n    iziToast.show({\n      message: 'Sorry, you are not enter search parametrs!',\n      ...iziToastOptions,\n    });\n    return;\n  }\n\n  pageNumber = 1;\n  searchList.innerHTML = '';\n  loadMoreBtn.classList.add('hide');\n  spinner.classList.add('loader');\n\n  try {\n    const images = await getPixabayImages(searchValue, pageNumber);\n    renderPixabayImgList(images.hits, searchList);\n    gallery.refresh();\n    loadMoreBtn.classList.remove('hide');\n  } catch (error) {\n    iziToast.show({\n      message: `${error}`,\n      ...iziToastOptions,\n    });\n  }\n\n  spinner.classList.remove('loader');\n  event.target.reset();\n}\n\nasync function handleLoadMoreBtn() {\n  pageNumber += 1;\n  loadMoreBtn.classList.add('hide');\n  spinner.classList.add('loader');\n\n  try {\n    const images = await getPixabayImages(searchValue, pageNumber);\n    renderPixabayImgList(images.hits, searchList);\n    gallery.refresh();\n  } catch (error) {\n    iziToast.show({\n      message: `${error}`,\n      ...iziToastOptions,\n    });\n  }\n\n  spinner.classList.remove('loader');\n  const galleryItem = searchList.firstElementChild;\n  const top = galleryItem.getBoundingClientRect().height;\n\n  window.scrollBy({\n    top: top * 2,\n    left: 0,\n    behavior: 'smooth',\n  });\n\n  if (pageNumber === lastPageNumber) {\n    loadMoreBtn.classList.add('hide');\n    iziToast.show({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      ...iziToastOptions,\n    });\n  } else {\n    loadMoreBtn.classList.remove('hide');\n  }\n}\n"],"names":["octagon","lastPageNumber","getPixabayImages","value","pageNumber","axios","searchParams","images","renderPixabayImgList","searchList","imagesList","largeImageURL","webformatURL","tags","likes","views","comments","downloads","searchForm","spinner","loadMoreBtn","handlerSubmit","handleLoadMoreBtn","gallery","SimpleLightbox","iziToastOptions","searchValue","event","iziToast","error","top"],"mappings":"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"}